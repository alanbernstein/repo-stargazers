<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Who starred my repo</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
	<style>
		h1 {
			margin: 50px 0;
		}

		h2 {
			font-size: 24px;
			margin: 0 0 25px;
		}

		#results {
			margin-top: 50px;
		}

		#results ul {
			margin: 0;
			padding: 0;
			list-style: none;
		}

		#results ul li {
			display: block;
			max-width: 250px;
			margin: 5px auto;
			text-align: left;
		}

		#results ul li img {
			width: 50px;
			padding-right: 10px;
		}
	</style>
</head>
<body>
	<div class="container text-center">
		<header class="row">
			<div class="col-md-6 col-md-offset-3">
				<h1>Who starred my repo?</h1>
			</div>
		</header>
		<div class="row">
			<div class="col-md-6 col-md-offset-3">
				<form action="/" method="get" id="form" class="form-inline">
					<div class="form-group">
						<label for="form-owner">Owner</label>
						<input type="text" id="form-owner" class="form-control" placeholder="jquery" required>
					</div>
					<div class="form-group">
						<label for="form-owner">Repo</label>
						<input type="text" id="form-repo" class="form-control" placeholder="jquery" required>
					</div>
					<button type="submit" class="btn btn-primary">Continue</button>
				</form>
			</div>
		</div>
		<div class="row">
			<div class="col-md-6 col-md-offset-3">
				<div id="results"></div>
			</div>
		</div>
	</div>

	<script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
	<script>
		$(function () {

			$('#form').on('submit', function (e) {
				var owner = $('#form-owner').val(),
					repo = $('#form-repo').val(),
					$results = $('#results');

				e.preventDefault();

				$results.html('<span class="fa fa-spinner fa-spin"></span> Loading...');
				$.get('http://localhost:3000/get/'+ owner +'/'+ repo, function (data) {

					if (data.code && data.code === 'error') {
						$results.html('<div class="alert alert-danger">'+ data.message +'</div>');
						return;
					}


					var $list = $('<ul></ul>');
					$results.html('<h2>Top 10 users who starred your repo:</h2>');
					$results.append($list);

				 	$.each(data, function (key, value) {
				 		$list.append('<li>'+
				 			'<a href="https://github.com/'+ value.name +'">'+
				 				'<img src="'+ value.avatar +'" alt="'+ value.name  +'">'+
				 				'<span class="name">'+ value.name +':</span>'+
				 			'</a> '+
				 			'<span class="stars">'+ value.stars +' <span class="fa fa-star"></span></span>'+
				 		'</li>');
				 	});

				}, 'json');
			});

		});
	</script>
</body>
</html>